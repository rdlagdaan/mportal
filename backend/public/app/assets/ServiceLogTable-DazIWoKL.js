import{j as e,n}from"./index-D9IC_3U1.js";import{r as l}from"./handsontable-DB04mlRq.js";import"./react-DJG_os-6.js";function _({assetId:o}){const[p,m]=l.useState([]),[x,g]=l.useState(10),[t,b]=l.useState(1),[i,j]=l.useState(1),[u,h]=l.useState(!1);async function a(s=t){h(!0);try{const r=await n.get(`/app/api/assets/${o}/service-logs`,{params:{per:x,page:s}});m(r.data.data),b(r.data.current_page),j(r.data.last_page)}finally{h(!1)}}l.useEffect(()=>{a(1)},[o]);async function N(){const s=new Date().toISOString().slice(0,10);await n.post(`/app/api/assets/${o}/service-logs`,{service_date:s,description:"",parts_cost:0,labor_cost:0}),await a(1)}async function c(s,r){await n.patch(`/app/api/service-logs/${s.id}`,r),await a(t)}async function y(s){if(!confirm("Delete this service log?"))return;await n.delete(`/app/api/service-logs/${s.id}`);const r=p.length===1&&t>1?t-1:t;await a(r)}return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:N,className:"px-3 py-2 bg-green-700 text-white rounded",children:"New Service Entry"}),e.jsxs("div",{className:"ml-auto text-sm text-gray-600",children:["Per page",e.jsx("select",{value:x,onChange:s=>{g(Number(s.target.value)),a(1)},className:"ml-2 border rounded px-2 py-1",children:[10,20,50].map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"border rounded overflow-hidden",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2",children:"Date"}),e.jsx("th",{className:"p-2",children:"Description"}),e.jsx("th",{className:"p-2 text-right",children:"Parts"}),e.jsx("th",{className:"p-2 text-right",children:"Labor"}),e.jsx("th",{className:"p-2",children:"Next Due"}),e.jsx("th",{className:"p-2 w-24",children:"Actions"})]})}),e.jsxs("tbody",{children:[p.map((s,r)=>e.jsxs("tr",{className:r%2?"bg-gray-50":"",children:[e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:s.service_date,onChange:d=>c(s,{service_date:d.target.value})})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full border rounded px-2 py-1",value:s.description||"",onChange:d=>c(s,{description:d.target.value})})}),e.jsx("td",{className:"p-2 text-right",children:e.jsx("input",{type:"number",min:0,step:.01,className:"w-28 border rounded px-2 py-1 text-right",value:s.parts_cost||0,onChange:d=>c(s,{parts_cost:Number(d.target.value||0)})})}),e.jsx("td",{className:"p-2 text-right",children:e.jsx("input",{type:"number",min:0,step:.01,className:"w-28 border rounded px-2 py-1 text-right",value:s.labor_cost||0,onChange:d=>c(s,{labor_cost:Number(d.target.value||0)})})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:s.next_due_date||"",onChange:d=>c(s,{next_due_date:d.target.value})})}),e.jsx("td",{className:"p-2",children:e.jsx("button",{onClick:()=>y(s),className:"px-2 py-1 border rounded text-red-600",children:"Delete"})})]},s.id)),!u&&p.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-4 text-center text-gray-500",children:"No service logs yet"})})]})]}),u&&e.jsx("div",{className:"p-3 text-center",children:"Loadingâ€¦"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{children:["Page ",t," of ",i]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>a(1),disabled:t===1,className:"px-3 py-1 border rounded disabled:opacity-50",children:"First"}),e.jsx("button",{onClick:()=>a(t-1),disabled:t===1,className:"px-3 py-1 border rounded disabled:opacity-50",children:"Prev"}),e.jsx("button",{onClick:()=>a(t+1),disabled:t===i,className:"px-3 py-1 border rounded disabled:opacity-50",children:"Next"}),e.jsx("button",{onClick:()=>a(i),disabled:t===i,className:"px-3 py-1 border rounded disabled:opacity-50",children:"Last"})]})]})]})}export{_ as default};
