import{n as S,j as n}from"./index-Bt_bdq66.js";import{r as a}from"./handsontable-DB04mlRq.js";import"./react-DJG_os-6.js";function A({placeholder:g,fetchUrl:b,selectedLabel:h,onChange:y}){const[r,l]=a.useState(!1),[i,c]=a.useState(""),[u,d]=a.useState([]),[o,f]=a.useState(!1),s=a.useRef(null);a.useEffect(()=>{r&&m()},[r]),a.useEffect(()=>{if(r)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>void m(),200),()=>{s.current&&clearTimeout(s.current)}},[i,r]);async function m(){f(!0);try{const t=await S.get(b,{params:{q:i}}),_=(Array.isArray(t.data?.data)?t.data.data:Array.isArray(t.data)?t.data:[]).map(e=>"value"in e&&"label"in e?{id:e.id,value:String(e.value),label:String(e.label)}:"class_code"in e?{id:e.id,value:String(e.class_code),label:`${e.class_code} — ${e.class_name??""}`.trim()}:"cat_code"in e?{id:e.id,value:String(e.cat_code),label:`${e.cat_code} — ${e.cat_name??""}`.trim()}:"type_code"in e?{id:e.id,value:String(e.type_code),label:`${e.type_code} — ${e.type_name??""}`.trim()}:"vendor_code"in e?{id:e.id,value:String(e.vendor_code),label:e.vendor_name??e.vendor_code}:{id:e.id,value:String(e.value??e.code??e.id??""),label:String(e.label??e.name??e.title??e.value??"")}),p=new Set;d(_.filter(e=>{const v=`${e.value}::${e.label}`;return p.has(v)?!1:(p.add(v),!0)}))}catch{d([])}finally{f(!1)}}return n.jsxs("div",{className:"relative",children:[n.jsx("input",{onFocus:()=>l(!0),value:r?i:h||"",onChange:t=>c(t.target.value),onBlur:()=>setTimeout(()=>l(!1),150),placeholder:g||"Search…",className:"w-full border-2 border-green-300 rounded-lg px-3 py-2 text-[15px] focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 bg-white"}),r&&n.jsxs("div",{className:"absolute z-10 mt-1 w-full max-h-60 overflow-auto bg-white border rounded shadow",children:[o&&n.jsx("div",{className:"p-2 text-sm text-gray-600",children:"Loading…"}),!o&&u.length===0&&n.jsx("div",{className:"p-2 text-sm text-gray-600",children:"No results"}),!o&&u.map(t=>n.jsx("div",{className:"px-3 py-2 hover:bg-gray-100 cursor-pointer",onMouseDown:()=>{y(t),c(""),l(!1)},children:t.label},`${t.value}`))]})]})}export{A as default};
