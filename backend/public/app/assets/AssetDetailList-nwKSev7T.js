import{n as g,j as e}from"./index-nFFOqXuJ.js";import{r as t}from"./handsontable-DB04mlRq.js";import F from"./AssetDetailModal-BONmxTO7.js";import{F as q,b as I,a as M}from"./TrashIcon-Tllugt5b.js";import"./react-DJG_os-6.js";import"./SearchableCombo-CbEDOv7z.js";function O({title:i,titleId:d,...p},u){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:u,"aria-labelledby":d},p),i?t.createElement("title",{id:d},i):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 7.5 7.5 3m0 0L12 7.5M7.5 3v13.5m13.5 0L16.5 21m0 0L12 16.5m4.5 4.5V7.5"}))}const o=t.forwardRef(O);function V(){const[i,d]=t.useState([]),[p,u]=t.useState(!1),[h,w]=t.useState(""),[b,y]=t.useState(""),[x,v]=t.useState(10),[a,S]=t.useState(1),[m,A]=t.useState(1),[j,E]=t.useState("purchase_date"),[C,k]=t.useState("desc"),[L,N]=t.useState(!1),[D,f]=t.useState(null),l=t.useRef(null);t.useEffect(()=>(l.current&&clearTimeout(l.current),l.current=setTimeout(()=>y(h.trim()),300),()=>{l.current&&clearTimeout(l.current)}),[h]),t.useEffect(()=>{(async()=>{try{const s=await g.get("/app/api/settings/paginaterecs");v(Number(s.data?.value)||10)}catch{}await c(1)})()},[]),t.useEffect(()=>{c(1)},[b,j,C,x]);async function c(s=a){u(!0);try{const n=await g.get("/app/api/assets",{params:{q:b,per:x,page:s,order:j,dir:C}});d(n.data.data),S(n.data.current_page),A(n.data.last_page)}finally{u(!1)}}function r(s){j===s?k(n=>n==="asc"?"desc":"asc"):(E(s),k("asc"))}function R(){f(null),N(!0)}function _(s){f(s),N(!0)}async function P(s){if(!confirm("Archive this asset?"))return;await g.delete(`/app/api/assets/${s}`);const n=i.length===1&&a>1?a-1:a;await c(n)}return e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("button",{onClick:R,className:"inline-flex items-center gap-2 bg-green-700 text-white px-4 py-2 rounded hover:bg-green-600",children:[e.jsx(q,{className:"h-5 w-5"})," Add Asset Detail"]}),e.jsx("input",{value:h,onChange:s=>w(s.target.value),placeholder:"Search asset no / description / reference / supplier / notes…",className:"w-96 border rounded px-3 py-2"}),e.jsx("button",{onClick:()=>{w(""),y("")},className:"px-3 py-2 border rounded",children:"Clear"}),e.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Per page"}),e.jsx("select",{value:x,onChange:s=>v(Number(s.target.value)),className:"border rounded px-2 py-1",children:[10,20,50,100].map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"border rounded shadow bg-white overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 w-10"}),e.jsxs("th",{className:"p-2 cursor-pointer whitespace-nowrap",onClick:()=>r("asset_no"),children:["Asset Number ",e.jsx(o,{className:"inline h-4 w-4"})]}),e.jsxs("th",{className:"p-2 cursor-pointer whitespace-nowrap",onClick:()=>r("description"),children:["Asset Desc ",e.jsx(o,{className:"inline h-4 w-4"})]}),e.jsxs("th",{className:"p-2 cursor-pointer whitespace-nowrap",onClick:()=>r("group_asset"),children:["Group Asset Name ",e.jsx(o,{className:"inline h-4 w-4"})]}),e.jsx("th",{className:"p-2 cursor-pointer",onClick:()=>r("life_months"),children:"Life"}),e.jsx("th",{className:"p-2 cursor-pointer",onClick:()=>r("quantity"),children:"Quantity"}),e.jsxs("th",{className:"p-2 cursor-pointer whitespace-nowrap",onClick:()=>r("gross_amount"),children:["Gross Amt ",e.jsx(o,{className:"inline h-4 w-4"})]}),e.jsxs("th",{className:"p-2 cursor-pointer whitespace-nowrap",onClick:()=>r("purchase_date"),children:["Purchased Date ",e.jsx(o,{className:"inline h-4 w-4"})]}),e.jsx("th",{className:"p-2 cursor-pointer",onClick:()=>r("reference"),children:"Reference"}),e.jsx("th",{className:"p-2 cursor-pointer",onClick:()=>r("supplier_name"),children:"Supplier"}),e.jsx("th",{className:"p-2",children:"Notes"}),e.jsx("th",{className:"p-2 w-20",children:"Actions"})]})}),e.jsxs("tbody",{children:[i.map((s,n)=>e.jsxs("tr",{className:n%2?"bg-gray-50":"",children:[e.jsx("td",{className:"p-2 text-center",children:e.jsx("button",{onClick:()=>P(s.id),title:"Archive",className:"text-red-600 hover:text-red-800",children:e.jsx(I,{className:"h-5 w-5"})})}),e.jsx("td",{className:"p-2 text-green-700 font-medium cursor-pointer",onClick:()=>_(s.id),children:s.asset_no}),e.jsx("td",{className:"p-2",children:s.description}),e.jsx("td",{className:"p-2",children:s.group_asset_name||s.type_code||""}),e.jsx("td",{className:"p-2",children:s.life_months}),e.jsx("td",{className:"p-2",children:s.quantity}),e.jsx("td",{className:"p-2",children:new Intl.NumberFormat().format(s.gross_amount||0)}),e.jsx("td",{className:"p-2 whitespace-nowrap",children:s.purchase_date||""}),e.jsx("td",{className:"p-2",children:s.reference||""}),e.jsx("td",{className:"p-2",children:s.supplier_name||""}),e.jsx("td",{className:"p-2 max-w-[16rem]",children:e.jsx("div",{className:"truncate",title:s.notes||"",children:s.notes||""})}),e.jsx("td",{className:"p-2",children:e.jsx("button",{onClick:()=>_(s.id),className:"text-blue-600 hover:text-blue-800",title:"Edit",children:e.jsx(M,{className:"h-5 w-5"})})})]},s.id)),!p&&i.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:12,className:"p-6 text-center text-gray-500",children:"No records found"})})]})]}),p&&e.jsx("div",{className:"p-4 text-center text-gray-600",children:"Loading…"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{children:["Page ",a," of ",m]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>c(1),disabled:a===1,className:"px-3 py-1 border rounded disabled:opacity-50",children:"First"}),e.jsx("button",{onClick:()=>c(a-1),disabled:a===1,className:"px-3 py-1 border rounded disabled:opacity-50",children:"Prev"}),e.jsx("button",{onClick:()=>c(a+1),disabled:a===m,className:"px-3 py-1 border rounded disabled:opacity-50",children:"Next"}),e.jsx("button",{onClick:()=>c(m),disabled:a===m,className:"px-3 py-1 border rounded disabled:opacity-50",children:"Last"})]})]}),L&&e.jsx(F,{id:D,onClose:async s=>{N(!1),f(null),s&&await c(a)}})]})}export{V as default};
