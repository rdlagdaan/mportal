import{j as e,n as u}from"./index-B04WbdRd.js";import{r}from"./handsontable-DB04mlRq.js";import"./react-DJG_os-6.js";function M(){const[a,d]=r.useState(""),[x,m]=r.useState(10),[l,i]=r.useState(1),[o,p]=r.useState([]),[t,n]=r.useState(null),[h,j]=r.useState(!1),[v,y]=r.useState(null);async function g(){const s=await u.get("/leave-requests",{params:{q:a,per:x,page:l}});p(s.data.data??s.data)}r.useEffect(()=>{g()},[a,x,l]);async function b(s){const N=await u.get(`/leave-requests/${s}`);n(N.data),y(N.data)}return e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("input",{className:"border px-2 py-1 rounded",placeholder:"Search (employee, leave type, status)",value:a,onChange:s=>d(s.target.value)}),e.jsxs("select",{className:"border px-2 py-1 rounded",value:x,onChange:s=>m(+s.target.value),children:[e.jsx("option",{children:"10"}),e.jsx("option",{children:"20"}),e.jsx("option",{children:"50"})]}),e.jsx("button",{className:"px-3 py-1 rounded bg-green-700 text-white",onClick:()=>j(!0),children:"File Leave"}),e.jsxs("div",{className:"ml-auto flex items-center gap-2 text-sm text-gray-500",children:[e.jsx("span",{children:"Page"}),e.jsx("input",{type:"number",min:1,className:"w-16 border rounded px-2 py-1",value:l,onChange:s=>i(Math.max(1,+s.target.value||1))})]})]}),e.jsx("div",{className:"border rounded overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-green-800 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-left",children:"Employee"}),e.jsx("th",{className:"p-2 text-left",children:"Leave Type"}),e.jsx("th",{className:"p-2 text-left",children:"Start"}),e.jsx("th",{className:"p-2 text-left",children:"End"}),e.jsx("th",{className:"p-2 text-left",children:"Part"}),e.jsx("th",{className:"p-2 text-left",children:"Status"}),e.jsx("th",{className:"p-2 text-left",children:"Details"})]})}),e.jsxs("tbody",{children:[o.map(s=>e.jsxs("tr",{className:"odd:bg-white even:bg-green-50",children:[e.jsx("td",{className:"p-2",children:s.employee_name}),e.jsx("td",{className:"p-2",children:s.leave_type_name}),e.jsx("td",{className:"p-2",children:s.start_date}),e.jsx("td",{className:"p-2",children:s.end_date}),e.jsx("td",{className:"p-2",children:s.part_day==="AM"?"AM Half":s.part_day==="PM"?"PM Half":"Full Day"}),e.jsx("td",{className:"p-2",children:e.jsx(f,{status:s.status})}),e.jsx("td",{className:"p-2",children:e.jsx("button",{className:"text-green-700 underline",onClick:()=>b(s.id),children:"View"})})]},s.id)),o.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"p-4 text-center text-gray-500",children:"No leave requests found."})})]})]})}),h&&e.jsx(_,{onClose:()=>j(!1),onSaved:async s=>{j(!1),await g(),s&&b(s)}}),v&&e.jsx(w,{data:v,onClose:()=>y(null)})]})}function f({status:a}){const d={DRAFT:"bg-gray-200 text-gray-800",SUBMITTED:"bg-yellow-100 text-yellow-800",APPROVED:"bg-green-100 text-green-800",REJECTED:"bg-red-100 text-red-700",CANCELLED:"bg-gray-100 text-gray-700"};return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${d[a]}`,children:a})}function _({onClose:a,onSaved:d}){const[x,m]=r.useState([]),[l,i]=r.useState({leave_type_id:"",start_date:"",end_date:"",part_day:"FULL",reason_text:""}),o=r.useMemo(()=>!(!l.leave_type_id||!l.start_date||!l.end_date),[l]);r.useEffect(()=>{(async()=>{const t=await u.get("/leave-types");m(t.data.data??t.data)})()},[]);async function p(t){const n={leave_type_id:+l.leave_type_id,start_date:l.start_date,end_date:l.end_date,part_day:l.part_day,reason_text:l.reason_text?.trim()||null,submit:t},h=await u.post("/leave-requests",n);d(h.data?.id)}return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30",children:e.jsxs("div",{className:"w-[700px] bg-white rounded-lg shadow-xl overflow-hidden",children:[e.jsx("div",{className:"bg-green-800 text-white px-4 py-2 text-lg",children:"Leave Application"}),e.jsx("div",{className:"p-4 space-y-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm mb-1",children:"Leave Type"}),e.jsxs("select",{className:"w-full border rounded px-2 py-1",value:l.leave_type_id,onChange:t=>i(n=>({...n,leave_type_id:t.target.value})),children:[e.jsx("option",{value:"",children:"-- Select --"}),x.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Start Date"}),e.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:l.start_date,onChange:t=>i(n=>({...n,start_date:t.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"End Date"}),e.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:l.end_date,onChange:t=>i(n=>({...n,end_date:t.target.value}))})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm mb-1",children:"Part Day"}),e.jsxs("select",{className:"w-full border rounded px-2 py-1",value:l.part_day,onChange:t=>i(n=>({...n,part_day:t.target.value})),children:[e.jsx("option",{value:"FULL",children:"Full Day"}),e.jsx("option",{value:"AM",children:"Half Day (AM)"}),e.jsx("option",{value:"PM",children:"Half Day (PM)"})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm mb-1",children:"Reason"}),e.jsx("textarea",{className:"w-full border rounded px-2 py-2",rows:4,placeholder:"Reason for leave",value:l.reason_text,onChange:t=>i(n=>({...n,reason_text:t.target.value}))})]})]})}),e.jsxs("div",{className:"p-4 flex gap-2 bg-green-50",children:[e.jsx("button",{className:"px-3 py-1 rounded bg-gray-200",onClick:a,children:"Cancel"}),e.jsx("button",{disabled:!o,className:`px-3 py-1 rounded ${o?"bg-green-700 text-white":"bg-green-200 text-white/60"}`,onClick:()=>p(!1),children:"Save Draft"}),e.jsx("button",{disabled:!o,className:`px-3 py-1 rounded ${o?"bg-yellow-600 text-white":"bg-yellow-200 text-white/60"}`,onClick:()=>p(!0),children:"Submit for Approval"})]})]})})}function w({data:a,onClose:d}){return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30",children:e.jsxs("div",{className:"w-[720px] bg-white rounded-lg shadow-xl overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between bg-green-800 text-white px-4 py-2",children:[e.jsx("div",{className:"text-lg",children:"Leave Details"}),e.jsx(f,{status:a.status})]}),e.jsxs("div",{className:"p-4 grid grid-cols-2 gap-3",children:[e.jsx(c,{label:"Employee",value:a.employee_name}),e.jsx(c,{label:"Leave Type",value:a.leave_type_name}),e.jsx(c,{label:"Start Date",value:a.start_date}),e.jsx(c,{label:"End Date",value:a.end_date}),e.jsx(c,{label:"Part Day",value:a.part_day==="AM"?"Half (AM)":a.part_day==="PM"?"Half (PM)":"Full Day"}),e.jsx(c,{label:"Requires Med Cert",value:a.requires_med_cert?"Yes":"No"}),e.jsx(c,{label:"Prior Notice (days)",value:a.prior_notice_days??"-"}),e.jsx(c,{label:"Submitted At",value:a.submitted_at??"-"}),e.jsx(c,{label:"Final Decision At",value:a.final_decision_at??"-"}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Reason"}),e.jsx("div",{className:"border rounded p-2 min-h-[80px] bg-green-50",children:a.reason_text||e.jsx("span",{className:"opacity-50",children:"â€”"})})]})]}),e.jsx("div",{className:"p-4 bg-green-50",children:e.jsx("button",{className:"px-3 py-1 rounded bg-gray-200",onClick:d,children:"Close"})})]})})}function c({label:a,value:d}){return e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:a}),e.jsx("div",{className:"border rounded px-2 py-1 bg-white",children:d})]})}export{M as default};
