import{j as s}from"./index-5iLmMJVd.js";import{r as o}from"./handsontable-DB04mlRq.js";import"./react-DJG_os-6.js";function E({label:h,placeholder:g="Search…",options:p,valueLabel:c,onInputChange:w,onSelect:x,required:v,readOnly:u=!1}){const[n,r]=o.useState(!1),[d,f]=o.useState(0),a=o.useRef(null),y=o.useRef(null),i=o.useMemo(()=>{const e=new Set,t=[];for(const l of p||[]){const b=`${String(l.id)}::${l.label}`;e.has(b)||(e.add(b),t.push(l))}return t},[p]).filter(e=>e.label.toLowerCase().includes((c||"").toLowerCase())),[j,m]=o.useState("");return o.useEffect(()=>{n&&a.current?.focus()},[n]),o.useEffect(()=>{n&&m(c||"")},[n]),s.jsxs("div",{className:"relative",ref:y,children:[s.jsx("label",{className:"block text-xs font-semibold text-green-800 tracking-wide uppercase mb-1",children:h}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{ref:a,className:"w-full border-2 border-green-300 rounded-lg px-3 py-2 text-[15px] focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 bg-white pr-9",placeholder:g,value:n?j:c,readOnly:u,onFocus:()=>r(!0),onChange:e=>{if(u)return;const t=e.target.value;m(t),w(t),r(!0),f(0)},onBlur:()=>setTimeout(()=>r(!1),120),onKeyDown:e=>{if(!u)if(n||r(!0),e.key==="ArrowDown")e.preventDefault(),f(t=>Math.min(t+1,Math.max(i.length-1,0)));else if(e.key==="ArrowUp")e.preventDefault(),f(t=>Math.max(t-1,0));else if(e.key==="Enter"){e.preventDefault();const t=i[d];t&&(x(t),r(!1),requestAnimationFrame(()=>a.current?.focus()))}else e.key==="Escape"&&(r(!1),requestAnimationFrame(()=>a.current?.focus()))},required:v}),s.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",onMouseDown:e=>{u||(e.preventDefault(),r(!0),requestAnimationFrame(()=>a.current?.focus()))},"aria-label":"Toggle options",children:"▼"})]}),n&&s.jsx("ul",{className:"absolute z-50 mt-1 max-h-56 w-full overflow-auto rounded-md border bg-white shadow-lg",children:i.length?i.map((e,t)=>s.jsx("li",{className:`px-3 py-2 cursor-pointer ${t===d?"bg-amber-100 font-semibold":"hover:bg-amber-50"}`,onMouseDown:l=>{l.preventDefault(),x(e),r(!1),m(e.label),requestAnimationFrame(()=>a.current?.focus())},children:e.label},`${e.id}-${e.label}`)):s.jsx("li",{className:"px-3 py-2 text-sm text-gray-500",children:"No matches"})}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Type to search; pick an item to bind."})]})}export{E as default};
