import{j as s}from"./index-CWa1H-NV.js";import{r as n}from"./handsontable-DB04mlRq.js";import"./react-DJG_os-6.js";function $({label:g,placeholder:w="Search…",options:p,valueLabel:i,onInputChange:k,onSelect:x,required:v,readOnly:u=!1}){const[r,o]=n.useState(!1),[d,m]=n.useState(0),[h,c]=n.useState(""),a=n.useRef(null),y=n.useMemo(()=>{const e=new Set,t=[];for(const l of p||[]){const b=`${String(l.id)}::${l.label}`;e.has(b)||(e.add(b),t.push(l))}return t},[p]),j=(r?h:i).toLowerCase(),f=y.filter(e=>e.label.toLowerCase().includes(j)),N=n.useRef(null);return n.useEffect(()=>{r&&(c(i||""),a.current?.focus())},[r,i]),s.jsxs("div",{ref:N,className:`relative ${r?"z-[80]":"z-auto"}`,children:[s.jsx("label",{className:"block text-xs font-semibold text-green-800 tracking-wide uppercase mb-1",children:g}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{ref:a,className:"w-full border-2 border-green-300 rounded-lg px-3 py-2 text-[15px] focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 bg-white pr-9",placeholder:w,value:r?h:i,readOnly:u,onFocus:()=>o(!0),onChange:e=>{if(u)return;const t=e.target.value;c(t),m(0)},onBlur:()=>setTimeout(()=>o(!1),120),onKeyDown:e=>{if(!u)if(r||o(!0),e.key==="ArrowDown")e.preventDefault(),m(t=>Math.min(t+1,Math.max(f.length-1,0)));else if(e.key==="ArrowUp")e.preventDefault(),m(t=>Math.max(t-1,0));else if(e.key==="Enter"){e.preventDefault();const t=f[d];t&&(x(t),c(t.label),o(!1),requestAnimationFrame(()=>a.current?.focus()))}else e.key==="Escape"&&(o(!1),requestAnimationFrame(()=>a.current?.focus()))},required:v}),s.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",onMouseDown:e=>{u||(e.preventDefault(),o(t=>!t),requestAnimationFrame(()=>a.current?.focus()))},"aria-label":"Toggle options",children:"▼"})]}),r&&s.jsx("ul",{className:"absolute z-[90] mt-1 max-h-56 w-full overflow-auto rounded-md border bg-white shadow-lg",children:f.length?f.map((e,t)=>s.jsx("li",{className:`px-3 py-2 cursor-pointer ${t===d?"bg-amber-100 font-semibold":"hover:bg-amber-50"}`,onMouseDown:l=>{l.preventDefault(),x(e),c(e.label),o(!1),requestAnimationFrame(()=>a.current?.focus())},children:e.label},`${e.id}-${e.label}`)):s.jsx("li",{className:"px-3 py-2 text-sm text-gray-500",children:"No matches"})}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Type to search; pick an item to bind."})]})}export{$ as default};
