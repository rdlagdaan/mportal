import{j as r}from"./index-Bt_bdq66.js";import{r as o}from"./handsontable-DB04mlRq.js";import"./react-DJG_os-6.js";function N({label:h,placeholder:b="Search…",options:m,valueLabel:u,onInputChange:w,onSelect:p,required:v,readOnly:i=!1}){const[c,s]=o.useState(!1),[d,f]=o.useState(0),n=o.useRef(null),x=o.useRef(null),l=o.useMemo(()=>{const e=new Set,t=[];for(const a of m||[]){const g=`${String(a.id)}::${a.label}`;e.has(g)||(e.add(g),t.push(a))}return t},[m]).filter(e=>e.label.toLowerCase().includes((u||"").toLowerCase()));return o.useEffect(()=>{n.current?.focus()},[c,u]),o.useEffect(()=>{const e=t=>{x.current?.contains(t.target)||s(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),r.jsxs("div",{className:"relative",ref:x,children:[r.jsx("label",{className:"block text-xs font-semibold text-green-800 tracking-wide uppercase mb-1",children:h}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{ref:n,className:"w-full border-2 border-green-300 rounded-lg px-3 py-2 text-[15px] focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 bg-white pr-9",placeholder:b,value:u,readOnly:i,onFocus:()=>s(!0),onChange:e=>{w(e.target.value),s(!0),f(0)},onKeyDown:e=>{if(!i)if(c||s(!0),e.key==="ArrowDown")e.preventDefault(),f(t=>Math.min(t+1,Math.max(l.length-1,0)));else if(e.key==="ArrowUp")e.preventDefault(),f(t=>Math.max(t-1,0));else if(e.key==="Enter"){e.preventDefault();const t=l[d];t&&(p(t),s(!1),requestAnimationFrame(()=>n.current?.focus()))}else e.key==="Escape"&&(s(!1),requestAnimationFrame(()=>n.current?.focus()))},required:v}),r.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",onMouseDown:e=>{i||(e.preventDefault(),s(t=>!t),requestAnimationFrame(()=>n.current?.focus()))},"aria-label":"Toggle options",children:"▼"})]}),c&&r.jsx("ul",{className:"absolute z-50 mt-1 max-h-56 w-full overflow-auto rounded-md border bg-white shadow-lg",children:l.length?l.map((e,t)=>r.jsx("li",{className:`px-3 py-2 cursor-pointer ${t===d?"bg-amber-100 font-semibold":"hover:bg-amber-50"}`,onMouseDown:a=>{a.preventDefault(),p(e),s(!1),requestAnimationFrame(()=>n.current?.focus())},children:e.label},`${e.id}-${e.label}`)):r.jsx("li",{className:"px-3 py-2 text-sm text-gray-500",children:"No matches"})}),r.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Type to search; pick an item to bind."})]})}export{N as default};
