import{n as f,j as e}from"./index-DBrcc5-Y.js";import{r as t}from"./handsontable-B9UYrM3w.js";import F from"./AssetDetailModal-DI3jz-bu.js";import{F as I,b as M,a as O}from"./TrashIcon-Be_nZ2Ki.js";import"./react-DJG_os-6.js";import"./SearchableCombo-oPOBtK-b.js";import"./ServiceLogTable-Bk5tS3gD.js";function Q({title:c,titleId:i,...d},o){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":i},d),c?t.createElement("title",{id:i},c):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 7.5 7.5 3m0 0L12 7.5M7.5 3v13.5m13.5 0L16.5 21m0 0L12 16.5m4.5 4.5V7.5"}))}const u=t.forwardRef(Q);function W(){const[c,i]=t.useState([]),[d,o]=t.useState(!1),[x,g]=t.useState(""),[b,w]=t.useState(""),[y,v]=t.useState(10),[a,_]=t.useState(1),[p,A]=t.useState(1),[h,E]=t.useState("purchase_date"),[C,k]=t.useState("desc"),[L,j]=t.useState(!1),[R,N]=t.useState(null),l=t.useRef(null);t.useEffect(()=>(l.current&&clearTimeout(l.current),l.current=setTimeout(()=>w(x.trim()),300),()=>{l.current&&clearTimeout(l.current)}),[x]),t.useEffect(()=>{(async()=>{try{const s=await f.get("/app/api/settings/paginaterecs");v(Number(s.data?.value)||10)}catch{}await r(1)})()},[]),t.useEffect(()=>{r(1)},[b,h,C]);async function r(s=a){o(!0);try{const n=await f.get("/app/api/assets",{params:{q:b,per:y,page:s,order:h,dir:C}});i(n.data.data),_(n.data.current_page),A(n.data.last_page)}finally{o(!1)}}function m(s){h===s?k(n=>n==="asc"?"desc":"asc"):(E(s),k("asc"))}function D(){N(null),j(!0)}function S(s){N(s),j(!0)}async function P(s){if(!confirm("Archive this asset?"))return;await f.delete(`/app/api/assets/${s}`);const n=c.length===1&&a>1?a-1:a;await r(n)}return e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:D,className:"inline-flex items-center gap-2 bg-green-700 text-white px-4 py-2 rounded hover:bg-green-600",children:[e.jsx(I,{className:"h-5 w-5"})," Add Asset Detail"]}),e.jsx("input",{value:x,onChange:s=>g(s.target.value),placeholder:"Search asset no/desc/ref/supplier/serial…",className:"w-96 border rounded px-3 py-2"}),e.jsx("button",{onClick:()=>{g(""),w("")},className:"px-3 py-2 border rounded",children:"Clear"}),e.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Per page"}),e.jsx("select",{value:y,onChange:s=>{v(Number(s.target.value)),r(1)},className:"border rounded px-2 py-1",children:[10,20,50,100].map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"border rounded shadow overflow-hidden bg-white",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 w-10"}),e.jsxs("th",{className:"p-2 cursor-pointer",onClick:()=>m("asset_no"),children:["Asset No ",e.jsx(u,{className:"inline h-4 w-4"})]}),e.jsxs("th",{className:"p-2 cursor-pointer",onClick:()=>m("description"),children:["Description ",e.jsx(u,{className:"inline h-4 w-4"})]}),e.jsx("th",{className:"p-2",children:"Type"}),e.jsx("th",{className:"p-2",children:"Life"}),e.jsx("th",{className:"p-2",children:"Qty"}),e.jsxs("th",{className:"p-2 cursor-pointer",onClick:()=>m("gross_amount"),children:["Gross Amt ",e.jsx(u,{className:"inline h-4 w-4"})]}),e.jsxs("th",{className:"p-2 cursor-pointer",onClick:()=>m("purchase_date"),children:["Purchased ",e.jsx(u,{className:"inline h-4 w-4"})]}),e.jsx("th",{className:"p-2",children:"Reference"}),e.jsx("th",{className:"p-2",children:"Supplier"}),e.jsx("th",{className:"p-2 w-20",children:"Actions"})]})}),e.jsxs("tbody",{children:[c.map((s,n)=>e.jsxs("tr",{className:n%2?"bg-gray-50":"",children:[e.jsx("td",{className:"p-2 text-center",children:e.jsx("button",{onClick:()=>P(s.id),title:"Archive",className:"text-red-600 hover:text-red-800",children:e.jsx(M,{className:"h-5 w-5"})})}),e.jsx("td",{className:"p-2 text-green-700 font-medium cursor-pointer",onClick:()=>S(s.id),children:s.asset_no}),e.jsx("td",{className:"p-2",children:s.description}),e.jsx("td",{className:"p-2",children:s.type_code}),e.jsx("td",{className:"p-2",children:s.life_months}),e.jsx("td",{className:"p-2",children:s.quantity}),e.jsx("td",{className:"p-2",children:new Intl.NumberFormat().format(s.gross_amount||0)}),e.jsx("td",{className:"p-2",children:s.purchase_date||""}),e.jsx("td",{className:"p-2",children:s.reference||""}),e.jsx("td",{className:"p-2",children:s.supplier_name||""}),e.jsx("td",{className:"p-2",children:e.jsx("button",{onClick:()=>S(s.id),className:"text-blue-600 hover:text-blue-800",title:"Edit",children:e.jsx(O,{className:"h-5 w-5"})})})]},s.id)),!d&&c.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:11,className:"p-6 text-center text-gray-500",children:"No records found"})})]})]}),d&&e.jsx("div",{className:"p-4 text-center text-gray-600",children:"Loading…"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{children:["Page ",a," of ",p]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>r(1),disabled:a===1,className:"px-3 py-1 border rounded disabled:opacity-50",children:"First"}),e.jsx("button",{onClick:()=>r(a-1),disabled:a===1,className:"px-3 py-1 border rounded disabled:opacity-50",children:"Prev"}),e.jsx("button",{onClick:()=>r(a+1),disabled:a===p,className:"px-3 py-1 border rounded disabled:opacity-50",children:"Next"}),e.jsx("button",{onClick:()=>r(p),disabled:a===p,className:"px-3 py-1 border rounded disabled:opacity-50",children:"Last"})]})]}),L&&e.jsx(F,{id:R,onClose:async s=>{j(!1),N(null),s&&await r(a)}})]})}export{W as default};
