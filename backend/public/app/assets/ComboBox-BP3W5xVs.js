import{j as r}from"./index-Bka1P-Hg.js";import{r as o}from"./handsontable-DB04mlRq.js";import"./react-DJG_os-6.js";function N({label:g,placeholder:h="Search…",options:f,valueLabel:m,onInputChange:v,onSelect:p,required:w,readOnly:u=!1}){const[i,s]=o.useState(!1),[d,c]=o.useState(0),n=o.useRef(null),x=o.useRef(null),l=o.useMemo(()=>{const e=new Set,t=[];for(const a of f||[]){const b=`${String(a.id)}::${a.label}`;e.has(b)||(e.add(b),t.push(a))}return t},[f]).filter(e=>e.label.toLowerCase().includes((m||"").toLowerCase()));return o.useEffect(()=>{i&&n.current?.focus()},[i]),o.useEffect(()=>{const e=t=>{x.current?.contains(t.target)||s(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),r.jsxs("div",{className:"relative",ref:x,children:[r.jsx("label",{className:"block text-xs font-semibold text-green-800 tracking-wide uppercase mb-1",children:g}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{ref:n,className:"w-full border-2 border-green-300 rounded-lg px-3 py-2 text-[15px] focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 bg-white pr-9",placeholder:h,value:m,readOnly:u,onFocus:()=>{},onMouseDown:e=>{u||(e.preventDefault(),s(!0),requestAnimationFrame(()=>n.current?.focus()))},onChange:e=>{v(e.target.value),s(!0),c(0)},onKeyDown:e=>{if(!u)if(i||s(!0),e.key==="ArrowDown")e.preventDefault(),c(t=>Math.min(t+1,Math.max(l.length-1,0)));else if(e.key==="ArrowUp")e.preventDefault(),c(t=>Math.max(t-1,0));else if(e.key==="Enter"){e.preventDefault();const t=l[d];t&&(p(t),s(!1),requestAnimationFrame(()=>n.current?.focus()))}else e.key==="Escape"&&(s(!1),requestAnimationFrame(()=>n.current?.focus()))},required:w}),r.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",onMouseDown:e=>{u||(e.preventDefault(),s(t=>!t),requestAnimationFrame(()=>n.current?.focus()))},"aria-label":"Toggle options",children:"▼"})]}),i&&r.jsx("ul",{className:"absolute z-50 mt-1 max-h-56 w-full overflow-auto rounded-md border bg-white shadow-lg",children:l.length?l.map((e,t)=>r.jsx("li",{className:`px-3 py-2 cursor-pointer ${t===d?"bg-amber-100 font-semibold":"hover:bg-amber-50"}`,onMouseDown:a=>{a.preventDefault(),p(e),s(!1),requestAnimationFrame(()=>n.current?.focus())},children:e.label},`${e.id}-${e.label}`)):r.jsx("li",{className:"px-3 py-2 text-sm text-gray-500",children:"No matches"})}),r.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Type to search; pick an item to bind."})]})}export{N as default};
