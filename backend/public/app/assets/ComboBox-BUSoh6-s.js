import{j as s}from"./index-SwmRNGSt.js";import{r as a}from"./handsontable-DB04mlRq.js";import"./react-DJG_os-6.js";function M({label:b,placeholder:w="Search…",options:p,valueLabel:i,onInputChange:N,onSelect:x,required:v,readOnly:u=!1}){const[o,r]=a.useState(!1),[d,m]=a.useState(0),[h,c]=a.useState(""),n=a.useRef(null),y=a.useMemo(()=>{const e=new Set,t=[];for(const l of p||[]){const g=`${String(l.id)}::${l.label}`;e.has(g)||(e.add(g),t.push(l))}return t},[p]),j=(o?h:i).toLowerCase(),f=y.filter(e=>e.label.toLowerCase().includes(j));return a.useEffect(()=>{o&&(c(i||""),n.current?.focus())},[o,i]),s.jsxs("div",{className:"relative",children:[s.jsx("label",{className:"block text-xs font-semibold text-green-800 tracking-wide uppercase mb-1",children:b}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{ref:n,className:"w-full border-2 border-green-300 rounded-lg px-3 py-2 text-[15px] focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-500 bg-white pr-9",placeholder:w,value:o?h:i,readOnly:u,onFocus:()=>r(!0),onChange:e=>{if(u)return;const t=e.target.value;c(t),m(0)},onBlur:()=>setTimeout(()=>r(!1),120),onKeyDown:e=>{if(!u)if(o||r(!0),e.key==="ArrowDown")e.preventDefault(),m(t=>Math.min(t+1,Math.max(f.length-1,0)));else if(e.key==="ArrowUp")e.preventDefault(),m(t=>Math.max(t-1,0));else if(e.key==="Enter"){e.preventDefault();const t=f[d];t&&(x(t),c(t.label),r(!1),requestAnimationFrame(()=>n.current?.focus()))}else e.key==="Escape"&&(r(!1),requestAnimationFrame(()=>n.current?.focus()))},required:v}),s.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",onMouseDown:e=>{u||(e.preventDefault(),r(t=>!t),requestAnimationFrame(()=>n.current?.focus()))},"aria-label":"Toggle options",children:"▼"})]}),o&&s.jsx("ul",{className:"absolute z-50 mt-1 max-h-56 w-full overflow-auto rounded-md border bg-white shadow-lg",children:f.length?f.map((e,t)=>s.jsx("li",{className:`px-3 py-2 cursor-pointer ${t===d?"bg-amber-100 font-semibold":"hover:bg-amber-50"}`,onMouseDown:l=>{l.preventDefault(),x(e),c(e.label),r(!1),requestAnimationFrame(()=>n.current?.focus())},children:e.label},`${e.id}-${e.label}`)):s.jsx("li",{className:"px-3 py-2 text-sm text-gray-500",children:"No matches"})}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Type to search; pick an item to bind."})]})}export{M as default};
